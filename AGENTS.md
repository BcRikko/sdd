# AIエージェント設定

このドキュメントは、[agents.md](https://agents.md/)仕様に従って、AIエージェントがこのリポジトリとどのように対話すべきかを説明しています。

## プロジェクト情報

- **名前**: SDD - 仕様駆動開発
- **タイプ**: CLIアプリケーション
- **言語**: JavaScript (Node.js)
- **テストフレームワーク**: Jest
- **方法論**: 仕様駆動開発（SDD）

## エージェントの機能

このプロジェクトで作業するAIエージェントは、以下の能力を持っている必要があります：

- 📝 Jestを使用したテストの作成と実行
- 💻 ES6+標準に従ったJavaScriptコードの実装
- 🔄 Red-Green-RefactorのTDDサイクルに従う
- 📚 ドキュメントの読み取りと更新
- 🏗️ ビルドおよびテストコマンドの実行

## 開発ワークフロー

### 基本原則

1. **テストファースト開発**: 常に実装前に仕様（テスト）を書く
2. **最小限の変更**: 目標を達成するために必要な最小限の変更を行う
3. **Red-Green-Refactor**: TDDサイクルを厳密に守る
4. **すべてのテストが合格**: 変更をコミットする前にすべてのテストが合格することを確認する

### 標準ワークフロー

```
1. 理解 → 課題/要件を読む
2. 仕様化 → __tests__/でテストを書く
3. Red → `npm test`を実行してテストが失敗することを確認
4. 実装 → src/に最小限のコードを書く
5. Green → `npm test`を実行してテストが成功することを確認
6. リファクタリング → テストをグリーンに保ちながらコードを改善
7. ドキュメント化 → 必要に応じてREADME.mdを更新
```

## プロジェクト構造

```
sdd/
├── __tests__/           # テスト仕様（最初にここにテストを書く）
│   └── cli.spec.js      # CLIテスト仕様
├── bin/                 # 実行可能スクリプト
│   └── cli.js           # CLIエントリーポイント
├── src/                 # ソースコード（テスト後に実装）
│   └── cli.js           # CLI実装
├── .github/             # GitHubおよびAIエージェント設定
│   ├── copilot-instructions.md
│   ├── claude-config.json
│   ├── agent-workflow.md
│   └── README.md
├── .clauderc            # Claude Code設定
├── AGENTS.md            # このファイル - AIエージェント仕様
├── README.md            # プロジェクトドキュメント
└── package.json         # プロジェクト設定
```

## コマンド

### テスト
```bash
npm test                 # すべてのテストを一度実行
npm run test:watch       # ウォッチモードでテストを実行（開発時）
```

### CLIの実行
```bash
node bin/cli.js          # CLIを直接実行
node bin/cli.js --help   # ヘルプを表示
node bin/cli.js --version # バージョンを表示
node bin/cli.js --greet <name> # 誰かに挨拶
```

### インストール
```bash
npm install              # 依存関係をインストール
npm link                 # 'sdd'コマンドとしてグローバルにインストール
```

## エージェントガイドライン

### 新機能を追加する場合

1. **要件を注意深く読む** - 何を実装する必要があるかを理解する
2. **最初にテストを書く** - `__tests__/cli.spec.js`にテストケースを追加
3. **テストが失敗することを確認** - `npm test`を実行してred状態を確認
4. **最小限のコードを実装** - `src/cli.js`にテストを通すためのコードを追加
5. **テストが成功することを確認** - `npm test`を実行してgreen状態を確認
6. **必要に応じてリファクタリング** - テストをグリーンに保ちながらコードを改善
7. **ドキュメントを更新** - 新しいコマンドを追加する場合は`README.md`を更新

### バグを修正する場合

1. **バグを再現** - 問題を示すテストを書く
2. **失敗を確認** - `npm test`でテストが失敗することを確認
3. **問題を修正** - `src/cli.js`のコードを修正
4. **修正を確認** - `npm test`ですべてのテストが合格することを確認

### リファクタリングする場合

1. **green状態を確認** - `npm test`を実行してすべてのテストが合格することを確認
2. **段階的に変更** - 小さなステップでリファクタリング
3. **各変更後にテスト** - `npm test`を頻繁に実行
4. **green状態を維持** - 失敗するテストがある状態でコミットしない

## コードスタイル

- `var`の代わりに`const`と`let`を使用
- 適切な場面でアロー関数を使用
- リポジトリ内の既存のコードパターンに従う
- 関数を小さく焦点を絞る（単一責任）
- 意味のある変数名と関数名を使用
- 明確性のために必要な場合にのみコメントを追加

## テストパターン

### 新しいCLIオプションの追加

```javascript
// 1. __tests__/cli.spec.jsにテストを追加
test('should handle --newopt flag', () => {
  const output = execSync(`node ${cliPath} --newopt value`).toString();
  expect(output).toContain('Expected output');
});

// 2. src/cli.jsに実装
case '--newopt':
  if (args[1]) {
    handleNewOption(args[1]);
  } else {
    console.error('Error: --newopt requires a value');
    process.exit(1);
  }
  break;

// 3. 関数を追加
function handleNewOption(value) {
  console.log(`Processing: ${value}`);
}

// 4. 必要に応じてエクスポート
module.exports = { run, handleNewOption, /* ... */ };
```

## 成功基準

タスクを完了とみなす前に、以下を確認してください：

- ✅ すべてのテストが合格（`npm test`がコード0で終了）
- ✅ コードが既存のパターンとスタイルに従っている
- ✅ 変更が最小限で焦点を絞っている
- ✅ ドキュメントが更新されている（該当する場合）
- ✅ 既存機能に破壊的な変更がない
- ✅ 不要な依存関係が追加されていない

## 避けるべきアンチパターン

- ❌ テストを書く前にコードを実装する
- ❌ 開発中にテスト実行をスキップする
- ❌ 大規模で広範囲な変更を行う
- ❌ 既存機能を壊す
- ❌ 正当な理由なく依存関係を追加する
- ❌ 失敗するテストがある状態でコミットする
- ❌ 既存のコードパターンを無視する

## コンテキストファイル

詳細情報については、エージェントは以下を参照してください：

- **`.github/copilot-instructions.md`** - GitHub Copilot固有の指示
- **`.github/agent-workflow.md`** - 詳細なエージェントワークフローガイド
- **`.github/claude-config.json`** - Claude Code JSON設定
- **`.clauderc`** - ルートレベルのClaude設定
- **`README.md`** - メインプロジェクトドキュメント

## エージェントタイプ

このリポジトリは、複数のAIエージェントタイプ向けに設定されています：

- **GitHub Copilot** - コード補完と提案
- **Claude Code** - エージェントコーディングと自律開発
- **カスタムエージェント** - agents.md仕様に従う任意のエージェント

## コミュニケーション

イシューやプルリクエストで作業する場合：

1. **要件を理解する** - イシューの説明を注意深く読む
2. **実装前に計画する** - コードを書く前に変更の概要を示す
3. **進捗を報告する** - PRの説明を進捗チェックリストで更新
4. **変更を説明する** - 明確なコミットメッセージを提供
5. **フィードバックに応答する** - レビューコメントに迅速に対処

## 制限事項

エージェントは以下を認識しておく必要があります：

- これはSDD原則に焦点を当てた学習/デモンストレーションプロジェクトです
- CLIは方法論を明確に示すために意図的にシンプルにしています
- 新機能は教育目的に沿ったものにする必要があります
- シンプルさを維持 - ソリューションを過度に設計しない

## リソース

- [仕様駆動開発](https://en.wikipedia.org/wiki/Test-driven_development) - TDD/SDD方法論
- [Jestドキュメント](https://jestjs.io/) - テストフレームワーク
- [Node.js CLIドキュメント](https://nodejs.org/api/cli.html) - CLI開発
- [agents.md](https://agents.md/) - AIエージェント仕様

## バージョン

- **仕様バージョン**: 1.0.0
- **最終更新**: 2024
- **メンテナンス**: プロジェクト貢献者

---

*このファイルは、リポジトリとのAIエージェント対話のための[agents.md](https://agents.md/)仕様に従っています。*
